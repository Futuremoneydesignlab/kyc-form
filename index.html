<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KYC申込フォーム</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://yubinbango.github.io/yubinbango/yubinbango.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script src="script.js" defer></script>
</head>
<body>
  <form id="kycForm" onsubmit="return handleSubmit(event)">

    <!-- STEP1～STEP8までをここに順に配置 -->
    <!-- すでに提供済みのSTEP1〜STEP8の各コードをここにそのまま貼り付けてください -->
<div class="form-step" id="step1">
  <h2>STEP1：担当者・紹介者情報</h2>

  <!-- タイムスタンプ（hiddenで自動） -->
  <input type="hidden" name="timestamp" id="timestamp" />

  <label for="agentName">担当者名</label>
  <input type="text" name="agentName" id="agentName" placeholder="例：山田さん" required />
  <div class="input-guide">※説明担当から聞いたイントロデューサー氏名を入力してください</div>

  <label for="referralCode">紹介コード</label>
  <input type="text" name="referralCode" id="referralCode" placeholder="例：1234-5678" required pattern="^[0-9\\-]{4,20}$" />
  <div class="input-guide">※数字とハイフンのみ（例：1234-5678）</div>
</div>
<div class="form-step" id="step2">
  <h2>STEP2：氏名・性別・生年月日</h2>

  <label for="lastName">姓（漢字）</label>
  <input type="text" name="lastName" id="lastName" required />

  <label for="firstName">名（漢字）</label>
  <input type="text" name="firstName" id="firstName" required />

  <label for="lastNameKana">セイ（カナ）</label>
  <input type="text" name="lastNameKana" id="lastNameKana" required pattern="^[ァ-ンヴー]+$" />

  <label for="firstNameKana">メイ（カナ）</label>
  <input type="text" name="firstNameKana" id="firstNameKana" required pattern="^[ァ-ンヴー]+$" />

  <label for="gender">性別</label>
  <select name="gender" id="gender" required>
    <option value="">選択してください</option>
    <option value="男性">男性</option>
    <option value="女性">女性</option>
    <option value="その他">その他</option>
  </select>

  <label for="birthDate">生年月日</label>
  <input type="date" name="birthDate" id="birthDate" required />
</div>
<div class="form-step h-adr" id="step3">
  <h2>STEP3：連絡先・現住所</h2>
  <span class="p-country-name" style="display:none;">Japan</span>

  <label for="phone">電話番号</label>
  <input type="tel" name="phone" id="phone" required pattern="^\\d{10,11}$" />

  <label for="email">メールアドレス</label>
  <input type="email" name="email" id="email" required />

  <label for="postalCode">郵便番号</label>
  <input type="text" name="postalCode" id="postalCode" class="p-postal-code" required pattern="^\\d{7}$" />

  <label for="prefecture">都道府県</label>
  <input type="text" name="prefecture" id="prefecture" class="p-region" required />

  <label for="city">市区町村</label>
  <input type="text" name="city" id="city" class="p-locality" required />

  <label for="street">番地</label>
  <input type="text" name="street" id="street" class="p-street-address" required />

  <label for="building">建物名（任意）</label>
  <input type="text" name="building" id="building" class="p-extended-address" />

  <label for="addressKana">住所（フリガナ）</label>
  <input type="text" name="addressKana" id="addressKana" required pattern="^[ァ-ンヴー\\s　]+$" />
</div>
<div class="form-step" id="step4">
  <h2>STEP4：本人確認書類情報</h2>

  <label for="idNumber">身分証明書番号</label>
  <input type="text" name="idNumber" id="idNumber" required />

  <label for="idIssueDate">身分証発行日</label>
  <input type="date" name="idIssueDate" id="idIssueDate" required />

  <label for="idExpiryDate">身分証有効期限</label>
  <input type="date" name="idExpiryDate" id="idExpiryDate" required />

  <label for="myNumber">個人番号（マイナンバー）</label>
  <input type="text" name="myNumber" id="myNumber" placeholder="例：123456789012" pattern="^\\d{12}$" />

  <label for="idFront">身分証明書（表）</label>
  <input type="file" name="idFront" id="idFront" accept="image/*,.pdf" required />

  <label for="idBack">身分証明書（裏）</label>
  <input type="file" name="idBack" id="idBack" accept="image/*,.pdf" required />

  <label for="proofFront">住居証明書（表）</label>
  <input type="file" name="proofFront" id="proofFront" accept="image/*,.pdf" required />

  <label for="proofBack">住居証明書（裏）</label>
  <input type="file" name="proofBack" id="proofBack" accept="image/*,.pdf" required />
</div>
<div class="form-step" id="step5">
  <h2>STEP5：勤務先・職業情報</h2>

  <label for="employerName">勤務先名</label>
  <input type="text" name="employerName" id="employerName" required />

  <label for="industry">職業（業種）</label>
  <select name="industry" id="industry" required>
    <option value="">選択してください</option>
    <option value="会社員">会社員</option>
    <option value="経営者">経営者</option>
    <option value="個人事業主">個人事業主</option>
    <option value="学生">学生</option>
    <option value="無職">無職</option>
    <option value="その他">その他</option>
  </select>

  <label for="position">職業（役職）</label>
  <input type="text" name="position" id="position" required />

  <label for="workPostalCode">勤務先 郵便番号</label>
  <input type="text" name="workPostalCode" id="workPostalCode" required pattern="^\\d{7}$" />

  <label for="workPrefecture">勤務先 都道府県</label>
  <input type="text" name="workPrefecture" id="workPrefecture" required />

  <label for="workCity">勤務先 市区町村</label>
  <input type="text" name="workCity" id="workCity" required />

  <label for="workStreet">勤務先 番地</label>
  <input type="text" name="workStreet" id="workStreet" required />

  <label for="workBuilding">勤務先 建物名（任意）</label>
  <input type="text" name="workBuilding" id="workBuilding" />

  <label for="income">年収（万円）</label>
  <input type="number" name="income" id="income" required min="0" />

  <label for="yearsEmployed">勤続年数</label>
  <input type="number" name="yearsEmployed" id="yearsEmployed" required min="0" />
</div>
<div class="form-step" id="step6">
  <h2>STEP6：投資プラン・支払方法</h2>

  <label for="investmentPlan">投資プラン</label>
  <input type="text" name="investmentPlan" id="investmentPlan" required />

  <label for="investmentTerm">投資期間（年）</label>
  <select name="investmentTerm" id="investmentTerm" required>
    <option value="">選択してください</option>
    <option value="10">10年</option>
    <option value="15">15年</option>
    <option value="20">20年</option>
    <option value="25">25年</option>
  </select>

  <label for="annualContribution">年間（一括）拠出額</label>
  <input type="number" name="annualContribution" id="annualContribution" required min="0" />

  <label for="currency">通貨</label>
  <select name="currency" id="currency" required>
    <option value="USD">USD</option>
    <option value="JPY">JPY</option>
    <option value="EUR">EUR</option>
  </select>

  <label for="paymentFrequency">支払頻度</label>
  <select name="paymentFrequency" id="paymentFrequency" required>
    <option value="一括">一括</option>
    <option value="年払">年払</option>
    <option value="月払">月払</option>
  </select>

  <label for="paymentMethod">支払方法</label>
  <select name="paymentMethod" id="paymentMethod" onchange="togglePaymentFields(this.value)" required>
    <option value="クレジットカード">クレジットカード</option>
    <option value="銀行振込">銀行振込</option>
  </select>
</div>

<div id="cardFields" style="display:none;">
  <label for="cardType">カード種類</label>
  <select name="cardType" id="cardType">
    <option value="VISA">VISA</option>
    <option value="MasterCard">MasterCard</option>
    <option value="AMEX">AMEX</option>
  </select>

  <label for="cardNumber">カード番号</label>
  <input type="text" name="cardNumber" id="cardNumber" pattern="^\\d{13,19}$" />

  <label for="cardExpiry">カード有効期限</label>
  <input type="month" name="cardExpiry" id="cardExpiry" />
</div>

<div id="bankFields" style="display:none;">
  <label for="bankName">銀行名</label>
  <input type="text" name="bankName" id="bankName" />

  <label for="bankBranch">支店名・支店番号</label>
  <input type="text" name="bankBranch" id="bankBranch" />

  <label for="bankAccountDate">口座開設日</label>
  <input type="date" name="bankAccountDate" id="bankAccountDate" />

  <label for="bankAccountNameKana">口座名義（カタカナ）</label>
  <input type="text" name="bankAccountNameKana" id="bankAccountNameKana" pattern="^[ァ-ンヴー\\s　]+$" />

  <label for="bankAccountNumber">口座番号</label>
  <input type="text" name="bankAccountNumber" id="bankAccountNumber" pattern="^\\d{5,12}$" />
</div>
<div class="form-step" id="step7">
  <h2>STEP7：資金源・投資目的・受益者情報</h2>

  <label for="fundIncome">年収（資金額ベース）</label>
  <input type="number" name="fundIncome" id="fundIncome" required min="0" />

  <label for="fundSource">資金調達方法</label>
  <select name="fundSource" id="fundSource" required>
    <option value="給与">給与</option>
    <option value="事業収入">事業収入</option>
    <option value="退職金">退職金</option>
    <option value="相続">相続</option>
    <option value="仮想通貨">仮想通貨</option>
  </select>

  <label for="investmentPurpose">投資の目的</label>
  <select name="investmentPurpose" id="investmentPurpose" required>
    <option value="老後資金">老後資金</option>
    <option value="教育資金">教育資金</option>
    <option value="相続対策">相続対策</option>
    <option value="資産形成">資産形成</option>
  </select>

  <h3>受益者情報（契約者と異なる場合のみ）</h3>

  <label for="beneficiaryLastName">受益者 姓</label>
  <input type="text" name="beneficiaryLastName" id="beneficiaryLastName" />

  <label for="beneficiaryFirstName">受益者 名</label>
  <input type="text" name="beneficiaryFirstName" id="beneficiaryFirstName" />

  <label for="beneficiaryRelation">契約者との関係</label>
  <input type="text" name="beneficiaryRelation" id="beneficiaryRelation" />
</div>
<div class="form-step" id="step8">
  <h2>STEP8：適合性チェック・宣誓・同意事項</h2>

  <!-- 適合性チェック -->
  <label for="q1">Q1. 保険・投資商品の申込で査定拒否されたことがありますか？</label>
  <select name="q1" id="q1" required>
    <option value="">選択してください</option>
    <option value="はい">はい</option>
    <option value="いいえ">いいえ</option>
  </select>

  <label for="q2">Q2. 重大な疾病で治療・手術・入院歴がありますか？</label>
  <select name="q2" id="q2" required>
    <option value="">選択してください</option>
    <option value="はい">はい</option>
    <option value="いいえ">いいえ</option>
  </select>

  <label for="q3">Q3. HIV・エイズ等の感染症に該当しますか？</label>
  <select name="q3" id="q3" required>
    <option value="">選択してください</option>
    <option value="はい">はい</option>
    <option value="いいえ">いいえ</option>
  </select>

  <label for="q4">Q4. 危険職業・紛争地への渡航予定はありますか？</label>
  <select name="q4" id="q4" required>
    <option value="">選択してください</option>
    <option value="はい">はい</option>
    <option value="いいえ">いいえ</option>
  </select>

  <label for="usTaxpayer">Q5. 米国納税義務者ですか？</label>
  <select name="usTaxpayer" id="usTaxpayer" required>
    <option value="">選択してください</option>
    <option value="はい">はい</option>
    <option value="いいえ">いいえ</option>
  </select>

  <label for="isPEP">Q6. あなたまたは親族がPEPs（政治的立場にある人物）に該当しますか？</label>
  <select name="isPEP" id="isPEP" required>
    <option value="">選択してください</option>
    <option value="はい">はい</option>
    <option value="いいえ">いいえ</option>
  </select>

  <hr />

  <!-- プライバシーポリシー -->
  <details class="policy-box" open>
    <summary>プライバシーポリシー</summary>
    <div class="policy-content">
      <ul>
        <li>取得した個人情報は、申込審査・本人確認・契約手続きに利用されます。</li>
        <li>法令に基づく場合を除き、本人の同意なく第三者提供しません。</li>
        <li>保管期間終了後は、適切に廃棄・削除されます。</li>
        <li>本人には、開示・訂正・削除・利用停止の請求権があります。</li>
      </ul>
    </div>
  </details>

  <!-- 宣誓文 -->
  <details class="policy-box" open>
    <summary>契約に関する宣誓</summary>
    <div class="policy-content">
      <ul>
        <li>私は、自主的にITA International Holdingsが提供する商品への投資を行うことを確認します。</li>
        <li>契約書作成に伴う個人情報の転記・記録に同意します。</li>
        <li>本フォームの内容に虚偽がないことを宣誓し、変更時は速やかに報告・訂正します。</li>
        <li>本申込に関する情報が税務当局と共有される場合があることに同意します。</li>
      </ul>
    </div>
  </details>

  <label>
    <input type="checkbox" name="finalConsent" required />
    上記のプライバシーポリシーと宣誓内容を確認し、同意します。
  </label>
</div>

    <!-- 送信ボタン -->
    <div class="form-step">
      <button type="submit">申込内容を送信する</button>
    </div>
  </form>

  <script>
    // JSTタイムスタンプ自動設定
    window.addEventListener("DOMContentLoaded", () => {
      const now = new Date();
      const jst = new Date(now.getTime() + 9 * 60 * 60 * 1000);
      document.getElementById("timestamp").value = jst.toISOString();
    });

    // 支払方法切り替え
    function togglePaymentFields(value) {
      document.getElementById("cardFields").style.display = value === "クレジットカード" ? "block" : "none";
      document.getElementById("bankFields").style.display = value === "銀行振込" ? "block" : "none";
    }
  </script>
</body>
</html>
